-- ç„ä¸›è…³æœ¬ - ç°¡åŒ–ä¿®å¾©ç‰ˆ v9.8
print("ğŸ® =================================")
print("ğŸ® ç„ä¸›è…³æœ¬ - ç°¡åŒ–ä¿®å¾©ç‰ˆ v9.8")
print("ğŸ® ç§¦å§‹çš‡åˆ›ä½œ")
print("ğŸ® å°ˆæ¥­ç´šéŠæˆ²è¼”åŠ©")
print("ğŸ® =================================")

-- æª¢æ¸¬è¨­å‚™é¡å‹
local inputService = game:GetService("UserInputService")
local tweenService = game:GetService("TweenService")
local runService = game:GetService("RunService")
local players = game:GetService("Players")

local isMobile = inputService.TouchEnabled
local isDesktop = inputService.MouseEnabled
local deviceType = isMobile and "ğŸ“± æ‰‹æ©Ÿ" or "ğŸ–¥ï¸ é›»è…¦"
print("âœ… æª¢æ¸¬åˆ°è¨­å‚™: " .. deviceType)

-- ç¢ºä¿éŠæˆ²å®Œå…¨åŠ è¼‰
repeat task.wait() until game:IsLoaded()
print("âœ… éŠæˆ²å·²åŠ è¼‰")

-- ç²å–ç©å®¶
local player = players.LocalPlayer
if not player then
    warn("âŒ ç„¡æ³•ç²å–ç©å®¶")
    return
end
print("âœ… ç©å®¶: " .. player.Name)

-- ç­‰å¾…PlayerGui
local playerGui
local success, errorMsg = pcall(function()
    playerGui = player:WaitForChild("PlayerGui", 10)
end)

if not success or not playerGui then
    warn("âŒ ç„¡æ³•æ‰¾åˆ°PlayerGuiï¼Œå˜—è©¦ä½¿ç”¨CoreGui")
    playerGui = game:GetService("CoreGui")
end
print("âœ… UIå®¹å™¨: " .. playerGui.Name)

-- æ¸…ç†èˆŠçš„UI
for _, gui in ipairs(playerGui:GetChildren()) do
    if gui.Name:find("XuanCong") or gui.Name:find("ç„ä¸›") then
        gui:Destroy()
        print("ğŸ—‘ï¸ æ¸…ç†äº†èˆŠUI: " .. gui.Name)
    end
end

-- ========================
-- å‰µå»ºä¸»UI ScreenGui
-- ========================
print("ğŸ”§ å‰µå»ºä¸»UI...")

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ç„ä¸›è…³æœ¬_v9_8"
screenGui.Parent = playerGui
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.DisplayOrder = 999
screenGui.IgnoreGuiInset = false

-- ========================
-- Luna Interface Suite é¢¨æ ¼è¼‰å…¥ç•«é¢ï¼ˆæ²’æœ‰é»‘è‰²èƒŒæ™¯ï¼‰
-- ========================
print("ğŸ¬ é¡¯ç¤º Luna Interface Suite è¼‰å…¥ç•«é¢...")

-- ä¸»è¦è¼‰å…¥ç•«é¢æ¡†æ¶ï¼ˆç›´æ¥å‰µå»ºï¼Œæ²’æœ‰é»‘è‰²é®ç½©ï¼‰
local loadingFrame = Instance.new("Frame")
loadingFrame.Name = "LunaLoadingFrame"
loadingFrame.Size = UDim2.new(0, 450, 0, 180)
loadingFrame.Position = UDim2.new(0.5, -225, 0.5, -90)
loadingFrame.BackgroundColor3 = Color3.fromRGB(15, 20, 30)
loadingFrame.BackgroundTransparency = 0.05
loadingFrame.BorderSizePixel = 0
loadingFrame.ZIndex = 1001
loadingFrame.Parent = screenGui

-- é»‘è‰²é‚Šæ¡†
local borderFrame = Instance.new("Frame")
borderFrame.Name = "Border"
borderFrame.Size = UDim2.new(1, 4, 1, 4)
borderFrame.Position = UDim2.new(0, -2, 0, -2)
borderFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
borderFrame.BorderSizePixel = 0
borderFrame.ZIndex = 1000
borderFrame.Parent = loadingFrame

-- è—è‰²é ‚éƒ¨é‚Šæ¡†
local topBorder = Instance.new("Frame")
topBorder.Name = "TopBorder"
topBorder.Size = UDim2.new(1, 0, 0, 2)
topBorder.Position = UDim2.new(0, 0, 0, 0)
topBorder.BackgroundColor3 = Color3.fromRGB(0, 120, 215)
topBorder.BorderSizePixel = 0
topBorder.ZIndex = 1002
topBorder.Parent = loadingFrame

-- åœ“è§’
local frameCorner = Instance.new("UICorner")
frameCorner.CornerRadius = UDim.new(0, 6)
frameCorner.Parent = loadingFrame

local borderCorner = Instance.new("UICorner")
borderCorner.CornerRadius = UDim.new(0, 8)
borderCorner.Parent = borderFrame

-- Luna Interface Suite æ¨™é¡Œ
local titleLabel = Instance.new("TextLabel")
titleLabel.Name = "Title"
titleLabel.Size = UDim2.new(1, 0, 0, 20)
titleLabel.Position = UDim2.new(0, 0, 0, 10)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "Luna Interface Suite"
titleLabel.TextColor3 = Color3.fromRGB(220, 220, 255)
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 14
titleLabel.TextXAlignment = Enum.TextXAlignment.Center
titleLabel.ZIndex = 1002
titleLabel.Parent = loadingFrame

-- ä½œè€…æ¨™ç±¤
local authorLabel = Instance.new("TextLabel")
authorLabel.Name = "Author"
authorLabel.Size = UDim2.new(1, 0, 0, 14)
authorLabel.Position = UDim2.new(0, 0, 0, 28)
authorLabel.BackgroundTransparency = 1
authorLabel.Text = "by Nebula Softworks"
authorLabel.TextColor3 = Color3.fromRGB(150, 150, 180)
authorLabel.Font = Enum.Font.Gotham
authorLabel.TextSize = 10
authorLabel.TextXAlignment = Enum.TextXAlignment.Center
authorLabel.ZIndex = 1002
authorLabel.Parent = loadingFrame

-- åˆ†éš”ç·š
local separator1 = Instance.new("Frame")
separator1.Name = "Separator1"
separator1.Size = UDim2.new(1, -40, 0, 1)
separator1.Position = UDim2.new(0, 20, 0, 50)
separator1.BackgroundColor3 = Color3.fromRGB(60, 80, 100)
separator1.BackgroundTransparency = 0.5
separator1.BorderSizePixel = 0
separator1.ZIndex = 1002
separator1.Parent = loadingFrame

-- ç³»çµ±åˆå§‹åŒ–æ¨™ç±¤
local systemLabel = Instance.new("TextLabel")
systemLabel.Name = "SystemLabel"
systemLabel.Size = UDim2.new(1, -40, 0, 18)
systemLabel.Position = UDim2.new(0, 20, 0, 60)
systemLabel.BackgroundTransparency = 1
systemLabel.Text = "[ ç³»çµ±åˆå§‹åŒ–ä¸­... ]"
systemLabel.TextColor3 = Color3.fromRGB(100, 200, 255)
systemLabel.Font = Enum.Font.Gotham
systemLabel.TextSize = 11
systemLabel.TextXAlignment = Enum.TextXAlignment.Left
systemLabel.ZIndex = 1002
systemLabel.Parent = loadingFrame

-- é€²åº¦æ¢èƒŒæ™¯
local progressBarBg = Instance.new("Frame")
progressBarBg.Name = "ProgressBarBg"
progressBarBg.Size = UDim2.new(1, -40, 0, 12)
progressBarBg.Position = UDim2.new(0, 20, 0, 85)
progressBarBg.BackgroundColor3 = Color3.fromRGB(30, 40, 50)
progressBarBg.BorderSizePixel = 0
progressBarBg.ZIndex = 1002
progressBarBg.Parent = loadingFrame

local barCorner = Instance.new("UICorner")
barCorner.CornerRadius = UDim.new(0, 4)
barCorner.Parent = progressBarBg

-- é€²åº¦æ¢å‰æ™¯
local progressBar = Instance.new("Frame")
progressBar.Name = "ProgressBar"
progressBar.Size = UDim2.new(0, 0, 1, 0) -- å¾0é–‹å§‹
progressBar.Position = UDim2.new(0, 0, 0, 0)
progressBar.BackgroundColor3 = Color3.fromRGB(0, 120, 215)
progressBar.BorderSizePixel = 0
progressBar.ZIndex = 1003
progressBar.Parent = progressBarBg

local progressCorner = Instance.new("UICorner")
progressCorner.CornerRadius = UDim.new(0, 4)
progressCorner.Parent = progressBar

-- è¼‰å…¥ç™¾åˆ†æ¯”æ¨™ç±¤
local percentLabel = Instance.new("TextLabel")
percentLabel.Name = "PercentLabel"
percentLabel.Size = UDim2.new(1, -40, 0, 16)
percentLabel.Position = UDim2.new(0, 20, 0, 100)
percentLabel.BackgroundTransparency = 1
percentLabel.Text = "è¼‰å…¥ä¸­ 0%"
percentLabel.TextColor3 = Color3.fromRGB(220, 220, 255)
percentLabel.Font = Enum.Font.Gotham
percentLabel.TextSize = 10
percentLabel.TextXAlignment = Enum.TextXAlignment.Center
percentLabel.ZIndex = 1002
percentLabel.Parent = loadingFrame

-- è³‡æ–™æ¥æ”¶æ¨™ç±¤
local dataLabel = Instance.new("TextLabel")
dataLabel.Name = "DataLabel"
dataLabel.Size = UDim2.new(1, -40, 0, 14)
dataLabel.Position = UDim2.new(0, 20, 0, 120)
dataLabel.BackgroundTransparency = 1
dataLabel.Text = "å·²æ¥æ”¶è³‡æ–™ï¼š0 / ä¸Šé™"
dataLabel.TextColor3 = Color3.fromRGB(150, 200, 100)
dataLabel.Font = Enum.Font.Gotham
dataLabel.TextSize = 10
dataLabel.TextXAlignment = Enum.TextXAlignment.Center
dataLabel.ZIndex = 1002
dataLabel.Parent = loadingFrame

-- åˆ†éš”ç·š2
local separator2 = Instance.new("Frame")
separator2.Name = "Separator2"
separator2.Size = UDim2.new(1, -40, 0, 1)
separator2.Position = UDim2.new(0, 20, 0, 140)
separator2.BackgroundColor3 = Color3.fromRGB(60, 80, 100)
separator2.BackgroundTransparency = 0.5
separator2.BorderSizePixel = 0
separator2.ZIndex = 1002
separator2.Parent = loadingFrame

-- æ¨¡å¼é¡¯ç¤ºæ¨™ç±¤
local modeLabel = Instance.new("TextLabel")
modeLabel.Name = "ModeLabel"
modeLabel.Size = UDim2.new(1, -40, 0, 12)
modeLabel.Position = UDim2.new(0, 20, 0, 145)
modeLabel.BackgroundTransparency = 1
modeLabel.Text = "æ¨¡å¼ï¼šé–‰éš±è— ç©¿æ’æ¨¡å¼"
modeLabel.TextColor3 = Color3.fromRGB(180, 180, 200)
modeLabel.Font = Enum.Font.Gotham
modeLabel.TextSize = 9
modeLabel.TextXAlignment = Enum.TextXAlignment.Left
modeLabel.ZIndex = 1002
modeLabel.Parent = loadingFrame

-- ç‹€æ…‹é¡¯ç¤ºæ¨™ç±¤
local statusLabel = Instance.new("TextLabel")
statusLabel.Name = "StatusLabel"
statusLabel.Size = UDim2.new(1, -40, 0, 12)
statusLabel.Position = UDim2.new(0, 20, 0, 160)
statusLabel.BackgroundTransparency = 1
statusLabel.Text = "ç‹€æ…‹ï¼šå®‰å…¨å€ - å·²åœç”¨ç©å®¶å°ç©å®¶"
statusLabel.TextColor3 = Color3.fromRGB(180, 180, 200)
statusLabel.Font = Enum.Font.Gotham
statusLabel.TextSize = 9
statusLabel.TextXAlignment = Enum.TextXAlignment.Left
statusLabel.ZIndex = 1002
statusLabel.Parent = loadingFrame

-- åº•éƒ¨æç¤º
local hintLabel = Instance.new("TextLabel")
hintLabel.Name = "HintLabel"
hintLabel.Size = UDim2.new(1, -40, 0, 16)
hintLabel.Position = UDim2.new(0, 20, 0, 175)
hintLabel.BackgroundTransparency = 1
hintLabel.Text = "< è«‹ç¨å€™ï¼Œæ­£åœ¨å»ºç«‹è»Œé“é€£çµ... >"
hintLabel.TextColor3 = Color3.fromRGB(100, 200, 255)
hintLabel.Font = Enum.Font.Gotham
hintLabel.TextSize = 9
hintLabel.TextXAlignment = Enum.TextXAlignment.Center
hintLabel.ZIndex = 1002
hintLabel.Parent = loadingFrame

-- ========================
-- ç°¡åŒ–ä½†å¯é çš„è¼‰å…¥å‹•ç•«
-- ========================
local dots = {"", ".", "..", "..."}
local dotIndex = 1
local progress = 0
local animationActive = true
local animationConnection

-- å‰µå»ºå´é‚ŠæŒ‰éˆ•ï¼ˆç«‹å³é¡¯ç¤ºï¼‰
local sidebarButton = Instance.new("TextButton")
sidebarButton.Name = "SidebarButton"
sidebarButton.Size = UDim2.new(0, 40, 0, 40)
sidebarButton.Position = UDim2.new(0, 10, 0, 10)
sidebarButton.BackgroundColor3 = Color3.fromRGB(0, 100, 200)
sidebarButton.BackgroundTransparency = 0.1
sidebarButton.BorderSizePixel = 0
sidebarButton.Text = "âš™ï¸"
sidebarButton.TextColor3 = Color3.fromRGB(255, 255, 255)
sidebarButton.Font = Enum.Font.GothamBold
sidebarButton.TextSize = 16
sidebarButton.AutoButtonColor = true
sidebarButton.ZIndex = 1000
sidebarButton.Visible = true
sidebarButton.Parent = screenGui

-- åœ“è§’
local sidebarCorner = Instance.new("UICorner")
sidebarCorner.CornerRadius = UDim.new(0, 8)
sidebarCorner.Parent = sidebarButton

-- é‚Šæ¡†
local sidebarStroke = Instance.new("UIStroke")
sidebarStroke.Color = Color3.fromRGB(0, 150, 255)
sidebarStroke.Thickness = 1.5
sidebarStroke.Parent = sidebarButton

-- æ‡¸åœæç¤º
local buttonHint = Instance.new("TextLabel")
buttonHint.Name = "ButtonHint"
buttonHint.Size = UDim2.new(0, 100, 0, 24)
buttonHint.Position = UDim2.new(0, 45, 0, 9)
buttonHint.BackgroundColor3 = Color3.fromRGB(20, 30, 45)
buttonHint.BackgroundTransparency = 0.1
buttonHint.Text = "é–‹å•Ÿç„ä¸›è…³æœ¬"
buttonHint.TextColor3 = Color3.fromRGB(220, 230, 255)
buttonHint.Font = Enum.Font.Gotham
buttonHint.TextSize = 10
buttonHint.TextXAlignment = Enum.TextXAlignment.Center
buttonHint.Visible = false
buttonHint.ZIndex = 999
buttonHint.Parent = screenGui

local hintCorner = Instance.new("UICorner")
hintCorner.CornerRadius = UDim.new(0, 5)
hintCorner.Parent = buttonHint

-- ========================
-- å´é‚ŠæŒ‰éˆ•æ‹–å‹•åŠŸèƒ½
-- ========================
local dragging = false
local dragInput
local dragStart
local startPos

-- é–‹å§‹æ‹–å‹•
local function beginDrag(input)
    dragging = true
    dragStart = input.Position
    startPos = sidebarButton.Position
    
    -- æ•æ‰æ»‘é¼ ç§»å‹•
    input.Changed:Connect(function()
        if input.UserInputState == Enum.UserInputState.End then
            dragging = false
        end
    end)
end

-- æ›´æ–°æ‹–å‹•ä½ç½®
local function updateDrag(input)
    if dragging then
        local delta = input.Position - dragStart
        sidebarButton.Position = UDim2.new(
            startPos.X.Scale, 
            startPos.X.Offset + delta.X,
            startPos.Y.Scale, 
            startPos.Y.Offset + delta.Y
        )
        
        -- æ›´æ–°æç¤ºä½ç½®
        buttonHint.Position = UDim2.new(
            0, 
            sidebarButton.Position.X.Offset + 45,
            0, 
            sidebarButton.Position.Y.Offset + 9
        )
    end
end

-- ç‚ºé›»è…¦è¨­å‚™è¨­ç½®æ‹–å‹•
if not isMobile then
    sidebarButton.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            beginDrag(input)
            return
        end
    end)

    sidebarButton.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)

    inputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            updateDrag(input)
        end
    end)
else
    -- ç‚ºæ‰‹æ©Ÿè¨­å‚™è¨­ç½®è§¸æ‘¸æ‹–å‹•
    local touchStartPos
    local touchStartTime
    local isDraggingTouch = false
    
    sidebarButton.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch then
            touchStartPos = input.Position
            touchStartTime = tick()
            isDraggingTouch = true
            
            -- é•·æŒ‰æª¢æ¸¬ï¼ˆé¿å…èˆ‡é»æ“Šè¡çªï¼‰
            task.spawn(function()
                task.wait(0.3) -- é•·æŒ‰0.3ç§’é–‹å§‹æ‹–å‹•
                if isDraggingTouch then
                    beginDrag(input)
                end
            end)
        end
    end)
    
    sidebarButton.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)
    
    inputService.InputChanged:Connect(function(input)
        if input == dragInput and isDraggingTouch then
            -- è¨ˆç®—è§¸æ‘¸ç§»å‹•è·é›¢
            local currentPos = input.Position
            local delta = (currentPos - touchStartPos).Magnitude
            
            -- å¦‚æœç§»å‹•è¶…é20åƒç´ ï¼Œé–‹å§‹æ‹–å‹•
            if delta > 20 then
                beginDrag(input)
                updateDrag(input)
            end
        end
    end)
    
    sidebarButton.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch then
            isDraggingTouch = false
            dragging = false
            
            -- æª¢æŸ¥æ˜¯å¦ç‚ºé»æ“Šï¼ˆçŸ­æŒ‰ï¼‰
            local touchEndTime = tick()
            if touchEndTime - touchStartTime < 0.3 then
                toggleUI() -- çŸ­æŒ‰æ˜¯é»æ“ŠåŠŸèƒ½
            end
        end
    end)
end

-- å•Ÿå‹•è¼‰å…¥å‹•ç•«
task.spawn(function()
    local startTime = tick()
    
    animationConnection = runService.RenderStepped:Connect(function()
        if not animationActive then
            animationConnection:Disconnect()
            return
        end
        
        -- è¨ˆç®—é€²åº¦ï¼ˆ3ç§’å®Œæˆï¼‰
        local elapsed = tick() - startTime
        progress = math.min(elapsed / 3 * 100, 100)
        
        -- æ›´æ–°é€²åº¦æ¢
        progressBar.Size = UDim2.new(progress / 100, 0, 1, 0)
        percentLabel.Text = "è¼‰å…¥ä¸­ " .. math.floor(progress) .. "%"
        
        -- æ›´æ–°è³‡æ–™
        local dataValue = math.floor(99 * (progress / 100))
        dataLabel.Text = "å·²æ¥æ”¶è³‡æ–™ï¼š" .. dataValue .. " / ä¸Šé™"
        
        -- æ›´æ–°æç¤ºå‹•ç•«
        dotIndex = dotIndex + 1
        if dotIndex > #dots then dotIndex = 1 end
        hintLabel.Text = "< è«‹ç¨å€™ï¼Œæ­£åœ¨å»ºç«‹è»Œé“é€£çµ" .. dots[dotIndex] .. " >"
        
        -- å®Œæˆæª¢æŸ¥
        if progress >= 100 then
            animationActive = false
            
            -- é¡¯ç¤ºå®Œæˆç‹€æ…‹
            percentLabel.Text = "è¼‰å…¥ä¸­ 100%"
            dataLabel.Text = "å·²æ¥æ”¶è³‡æ–™ï¼š99 / ä¸Šé™"
            hintLabel.Text = "< è»Œé“é€£çµå·²å»ºç«‹ >"
            progressBar.BackgroundColor3 = Color3.fromRGB(0, 200, 100)
            
            -- ç­‰å¾…1ç§’é¡¯ç¤ºå®Œæˆç‹€æ…‹
            task.wait(1)
            
            -- æ·¡å‡ºè¼‰å…¥ç•«é¢
            local fadeOut = tweenService:Create(loadingFrame, TweenInfo.new(0.5), {
                BackgroundTransparency = 1
            })
            
            -- åŒæ™‚æ·¡å‡ºæ‰€æœ‰æ–‡å­—
            local fadeOutTitle = tweenService:Create(titleLabel, TweenInfo.new(0.5), {
                TextTransparency = 1
            })
            
            local fadeOutAuthor = tweenService:Create(authorLabel, TweenInfo.new(0.5), {
                TextTransparency = 1
            })
            
            local fadeOutSystem = tweenService:Create(systemLabel, TweenInfo.new(0.5), {
                TextTransparency = 1
            })
            
            local fadeOutPercent = tweenService:Create(percentLabel, TweenInfo.new(0.5), {
                TextTransparency = 1
            })
            
            local fadeOutData = tweenService:Create(dataLabel, TweenInfo.new(0.5), {
                TextTransparency = 1
            })
            
            local fadeOutHint = tweenService:Create(hintLabel, TweenInfo.new(0.5), {
                TextTransparency = 1
            })
            
            local fadeOutMode = tweenService:Create(modeLabel, TweenInfo.new(0.5), {
                TextTransparency = 1
            })
            
            local fadeOutStatus = tweenService:Create(statusLabel, TweenInfo.new(0.5), {
                TextTransparency = 1
            })
            
            -- æ’­æ”¾æ‰€æœ‰æ·¡å‡ºå‹•ç•«
            fadeOut:Play()
            fadeOutTitle:Play()
            fadeOutAuthor:Play()
            fadeOutSystem:Play()
            fadeOutPercent:Play()
            fadeOutData:Play()
            fadeOutHint:Play()
            fadeOutMode:Play()
            fadeOutStatus:Play()
            
            -- ç­‰å¾…æ·¡å‡ºå®Œæˆ
            fadeOut.Completed:Wait()
            
            -- å®‰å…¨ç§»é™¤
            if loadingFrame and loadingFrame.Parent then
                loadingFrame:Destroy()
                print("âœ… Luna Interface Suite è¼‰å…¥ç•«é¢å®Œæˆ")
            end
            
            animationConnection:Disconnect()
        end
    end)
end)

-- å®‰å…¨æ©Ÿåˆ¶ï¼š5ç§’å¾Œå¼·åˆ¶ç§»é™¤è¼‰å…¥ç•«é¢
task.spawn(function()
    task.wait(5)
    
    if loadingFrame and loadingFrame.Parent then
        print("âš ï¸ å®‰å…¨æ©Ÿåˆ¶ï¼šå¼·åˆ¶ç§»é™¤è¼‰å…¥ç•«é¢")
        
        animationActive = false
        if animationConnection then
            animationConnection:Disconnect()
        end
        
        loadingFrame:Destroy()
        print("âœ… è¼‰å…¥ç•«é¢å·²å¼·åˆ¶ç§»é™¤")
    end
end)

-- ========================
-- å‰µå»ºä¸»æ¡†æ¶ï¼ˆé»æ“Šæ™‚é¡¯ç¤ºï¼‰
-- ========================
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 480, 0, 280)
mainFrame.Position = UDim2.new(0.5, -240, 0.5, -140)
mainFrame.BackgroundColor3 = Color3.fromRGB(15, 20, 30)
mainFrame.BackgroundTransparency = 0.05
mainFrame.BorderSizePixel = 0
mainFrame.Visible = false
mainFrame.Active = true
mainFrame.Parent = screenGui

-- é»‘è‰²èƒŒæ™¯é‚Šæ¡†
local bgFrame = Instance.new("Frame")
bgFrame.Name = "BackgroundFrame"
bgFrame.Size = UDim2.new(1, 4, 1, 4)
bgFrame.Position = UDim2.new(0, -2, 0, -2)
bgFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
bgFrame.BorderSizePixel = 0
bgFrame.ZIndex = -1
bgFrame.Parent = mainFrame

-- åœ“è§’
local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(0, 6)
uiCorner.Parent = mainFrame

local bgCorner = Instance.new("UICorner")
bgCorner.CornerRadius = UDim.new(0, 8)
bgCorner.Parent = bgFrame

-- è—è‰²é‚Šæ¡†
local borderFrame = Instance.new("Frame")
borderFrame.Name = "Border"
borderFrame.Size = UDim2.new(1, 0, 0, 2)
borderFrame.Position = UDim2.new(0, 0, 0, 0)
borderFrame.BackgroundColor3 = Color3.fromRGB(0, 120, 215)
borderFrame.BorderSizePixel = 0
borderFrame.ZIndex = 2
borderFrame.Parent = mainFrame

-- æ¨™é¡Œæ¬„
local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 32)
titleBar.Position = UDim2.new(0, 0, 0, 2)
titleBar.BackgroundTransparency = 1
titleBar.Parent = mainFrame

-- æ¨™é¡Œæ–‡å­—
local titleLabel = Instance.new("TextLabel")
titleLabel.Name = "TitleLabel"
titleLabel.Size = UDim2.new(1, -80, 1, 0)
titleLabel.Position = UDim2.new(0, 12, 0, 0)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "ç„ä¸›è…³æœ¬ v9.8"
titleLabel.TextColor3 = Color3.fromRGB(220, 220, 255)
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 13
titleLabel.TextXAlignment = Enum.TextXAlignment.Left
titleLabel.Parent = titleBar

-- é—œé–‰æŒ‰éˆ•
local closeButton = Instance.new("TextButton")
closeButton.Name = "CloseButton"
closeButton.Size = UDim2.new(0, 24, 0, 24)
closeButton.Position = UDim2.new(1, -28, 0, 4)
closeButton.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
closeButton.BackgroundTransparency = 0.3
closeButton.BorderSizePixel = 0
closeButton.Text = "Ã—"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.Font = Enum.Font.GothamBold
closeButton.TextSize = 18
closeButton.AutoButtonColor = true
closeButton.Parent = titleBar

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(0, 4)
closeCorner.Parent = closeButton

-- åˆ†éš”ç·š
local separator = Instance.new("Frame")
separator.Name = "Separator"
separator.Size = UDim2.new(1, -24, 0, 1)
separator.Position = UDim2.new(0, 12, 0, 36)
separator.BackgroundColor3 = Color3.fromRGB(60, 80, 100)
separator.BackgroundTransparency = 0.5
separator.BorderSizePixel = 0
separator.Parent = mainFrame

-- ========================
-- å‰µå»ºåŠŸèƒ½æŒ‰éˆ•ï¼ˆåˆ†é¡é¡¯ç¤ºï¼‰
-- ========================
print("ğŸ¯ å‰µå»ºåŠŸèƒ½æŒ‰éˆ•...")

-- è…³æœ¬å€ï¼ˆå·¦å´ï¼‰
local scriptsPanel = Instance.new("Frame")
scriptsPanel.Name = "ScriptsPanel"
scriptsPanel.Size = UDim2.new(0.5, -4, 0, 120)
scriptsPanel.Position = UDim2.new(0, 12, 0, 60) -- å¾€ä¸‹ç§»15px
scriptsPanel.BackgroundTransparency = 1
scriptsPanel.Parent = mainFrame

-- è…³æœ¬å€æ¨™é¡Œ
local scriptsTitle = Instance.new("TextLabel")
scriptsTitle.Name = "ScriptsTitle"
scriptsTitle.Size = UDim2.new(1, 0, 0, 20)
scriptsTitle.Position = UDim2.new(0, 0, 0, -25)
scriptsTitle.BackgroundTransparency = 1
scriptsTitle.Text = "ğŸ“œ è…³æœ¬å€"
scriptsTitle.TextColor3 = Color3.fromRGB(200, 200, 255)
scriptsTitle.Font = Enum.Font.GothamBold
scriptsTitle.TextSize = 11
scriptsTitle.TextXAlignment = Enum.TextXAlignment.Left
scriptsTitle.Parent = scriptsPanel

-- åŠŸèƒ½å€ï¼ˆå³å´ï¼‰
local functionsPanel = Instance.new("Frame")
functionsPanel.Name = "FunctionsPanel"
functionsPanel.Size = UDim2.new(0.5, -4, 0, 220)
functionsPanel.Position = UDim2.new(0.5, 0, 0, 60) -- å¾€ä¸‹ç§»15px
functionsPanel.BackgroundTransparency = 1
functionsPanel.Parent = mainFrame

-- åŠŸèƒ½å€æ¨™é¡Œ
local functionsTitle = Instance.new("TextLabel")
functionsTitle.Name = "FunctionsTitle"
functionsTitle.Size = UDim2.new(1, 0, 0, 20)
functionsTitle.Position = UDim2.new(0, 0, 0, -25)
functionsTitle.BackgroundTransparency = 1
functionsTitle.Text = "âš™ï¸ åŠŸèƒ½å€"
functionsTitle.TextColor3 = Color3.fromRGB(200, 200, 255)
functionsTitle.Font = Enum.Font.GothamBold
functionsTitle.TextSize = 11
functionsTitle.TextXAlignment = Enum.TextXAlignment.Left
functionsTitle.Parent = functionsPanel

-- æŒ‰éˆ•å‰µå»ºå‡½æ•¸
local function createHorizontalButton(text, icon, xPos, yPos, color, panel)
    local buttonFrame = Instance.new("Frame")
    buttonFrame.Name = text .. "Frame"
    buttonFrame.Size = UDim2.new(1, -8, 0, 32)
    buttonFrame.Position = UDim2.new(0, xPos, 0, yPos)
    buttonFrame.BackgroundTransparency = 1
    buttonFrame.Parent = panel
    
    local button = Instance.new("TextButton")
    button.Name = text
    button.Size = UDim2.new(1, 0, 1, 0)
    button.Position = UDim2.new(0, 0, 0, 0)
    button.BackgroundColor3 = Color3.fromRGB(30, 40, 55)
    button.BackgroundTransparency = 0.3
    button.BorderSizePixel = 0
    button.Text = ""
    button.AutoButtonColor = true
    button.Active = true
    button.Parent = buttonFrame
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 6)
    corner.Parent = button
    
    -- åœ–æ¨™
    local iconLabel = Instance.new("TextLabel")
    iconLabel.Name = "Icon"
    iconLabel.Size = UDim2.new(0, 24, 0, 24)
    iconLabel.Position = UDim2.new(0, 8, 0, 4)
    iconLabel.BackgroundTransparency = 1
    iconLabel.Text = icon
    iconLabel.TextColor3 = color
    iconLabel.Font = Enum.Font.GothamBold
    iconLabel.TextSize = 14
    iconLabel.TextXAlignment = Enum.TextXAlignment.Center
    iconLabel.Parent = buttonFrame
    
    -- æ–‡å­—
    local textLabel = Instance.new("TextLabel")
    textLabel.Name = "Text"
    textLabel.Size = UDim2.new(1, -40, 1, 0)
    textLabel.Position = UDim2.new(0, 36, 0, 0)
    textLabel.BackgroundTransparency = 1
    textLabel.Text = text
    textLabel.TextColor3 = Color3.fromRGB(220, 220, 255)
    textLabel.Font = Enum.Font.Gotham
    textLabel.TextSize = 12
    textLabel.TextXAlignment = Enum.TextXAlignment.Left
    textLabel.Parent = buttonFrame
    
    -- ç‹€æ…‹æŒ‡ç¤ºå™¨
    local statusIndicator = Instance.new("Frame")
    statusIndicator.Name = "StatusIndicator"
    statusIndicator.Size = UDim2.new(0, 8, 0, 8)
    statusIndicator.Position = UDim2.new(1, -14, 0.5, -4)
    statusIndicator.BackgroundColor3 = Color3.fromRGB(80, 80, 100)
    statusIndicator.BackgroundTransparency = 0.3
    statusIndicator.BorderSizePixel = 0
    statusIndicator.Parent = buttonFrame
    
    local statusCorner = Instance.new("UICorner")
    statusCorner.CornerRadius = UDim.new(1, 0)
    statusCorner.Parent = statusIndicator
    
    -- æ‡¸åœæ•ˆæœ
    button.MouseEnter:Connect(function()
        button.BackgroundColor3 = Color3.fromRGB(40, 50, 70)
    end)
    
    button.MouseLeave:Connect(function()
        button.BackgroundColor3 = Color3.fromRGB(30, 40, 55)
    end)
    
    return button, statusIndicator, textLabel, iconLabel
end

-- è…³æœ¬å€æŒ‰éˆ•ï¼ˆå·¦å´ï¼‰
local piScriptBtn, piStatus, piText, piIcon = createHorizontalButton("çš®è…³æœ¬", "ğŸ…¿ï¸", 0, 0, Color3.fromRGB(220, 150, 50), scriptsPanel)
local xaBtn, xaStatus, xaText, xaIcon = createHorizontalButton("XAè…³æœ¬", "ğŸŒŸ", 0, 40, Color3.fromRGB(220, 120, 50), scriptsPanel)

-- åŠŸèƒ½å€æŒ‰éˆ•ï¼ˆå³å´ï¼‰
local fastAttackBtn, fastAttackStatus, fastAttackText, fastAttackIcon = createHorizontalButton("å¿«é€Ÿæ”»æ“Š", "âš¡", 0, 0, Color3.fromRGB(0, 150, 220), functionsPanel)
local flightBtn, flightStatus, flightText, flightIcon = createHorizontalButton("é£›è¡Œè…³æœ¬", "âœˆï¸", 0, 40, Color3.fromRGB(100, 200, 100), functionsPanel)
local fpsBoostBtn, fpsStatus, fpsText, fpsIcon = createHorizontalButton("FPSå„ªåŒ–", "ğŸ–¥ï¸", 0, 80, Color3.fromRGB(180, 100, 220), functionsPanel)
local autoV4Btn, autoV4Status, autoV4Text, autoV4Icon = createHorizontalButton("è‡ªå‹•V4", "ğŸŒ€", 0, 120, Color3.fromRGB(150, 80, 200), functionsPanel)

-- ä½œè€…ä¿¡æ¯
local authorLabel = Instance.new("TextLabel")
authorLabel.Name = "AuthorLabel"
authorLabel.Size = UDim2.new(1, -24, 0, 20)
authorLabel.Position = UDim2.new(0, 12, 0, 245)
authorLabel.BackgroundTransparency = 1
authorLabel.Text = "ğŸ‘‘ ç§¦å§‹çš‡åˆ›ä½œ | ç„ä¸›è…³æœ¬ v9.8"
authorLabel.TextColor3 = Color3.fromRGB(150, 150, 180)
authorLabel.Font = Enum.Font.Gotham
authorLabel.TextSize = 10
authorLabel.TextXAlignment = Enum.TextXAlignment.Center
authorLabel.Parent = mainFrame

print("âœ… UIå‰µå»ºå®Œæˆ")

-- ========================
-- UIé¡¯ç¤º/éš±è—åŠŸèƒ½
-- ========================
local isUIVisible = false

local function toggleUI()
    isUIVisible = not isUIVisible
    
    if isUIVisible then
        mainFrame.Visible = true
        sidebarButton.Text = "ğŸ“‚"
        sidebarButton.BackgroundColor3 = Color3.fromRGB(0, 120, 220)
        buttonHint.Text = "é—œé–‰ç„ä¸›è…³æœ¬"
        
        mainFrame.BackgroundTransparency = 1
        
        local fadeIn = tweenService:Create(mainFrame, TweenInfo.new(0.3), {
            BackgroundTransparency = 0.05
        })
        fadeIn:Play()
    else
        sidebarButton.Text = "âš™ï¸"
        sidebarButton.BackgroundColor3 = Color3.fromRGB(0, 100, 200)
        buttonHint.Text = "é–‹å•Ÿç„ä¸›è…³æœ¬"
        
        local fadeOut = tweenService:Create(mainFrame, TweenInfo.new(0.2), {
            BackgroundTransparency = 1
        })
        fadeOut:Play()
        
        fadeOut.Completed:Wait()
        mainFrame.Visible = false
    end
end

-- ========================
-- äº‹ä»¶è™•ç†
-- ========================
print("ğŸ”§ è¨­ç½®äº‹ä»¶è™•ç†...")

-- æ‡¸åœæ•ˆæœ
sidebarButton.MouseEnter:Connect(function()
    buttonHint.Visible = true
    sidebarStroke.Color = Color3.fromRGB(0, 180, 255)
    sidebarButton.BackgroundColor3 = Color3.fromRGB(0, 120, 220)
end)

sidebarButton.MouseLeave:Connect(function()
    buttonHint.Visible = false
    sidebarStroke.Color = Color3.fromRGB(0, 150, 255)
    sidebarButton.BackgroundColor3 = Color3.fromRGB(0, 100, 200)
end)

-- å´é‚ŠæŒ‰éˆ•é»æ“Šï¼ˆåªç‚ºé›»è…¦è¨­å‚™ï¼‰
if not isMobile then
    sidebarButton.MouseButton1Click:Connect(function()
        toggleUI()
    end)
end

-- é—œé–‰æŒ‰éˆ•
closeButton.MouseButton1Click:Connect(function()
    toggleUI()
end)

-- ========================
-- å¿«é€Ÿæ”»æ“ŠåŠŸèƒ½
-- ========================
local fastAttackActive = false
local fastAttackConnection = nil

local function toggleFastAttack()
    fastAttackActive = not fastAttackActive
    
    if fastAttackActive then
        fastAttackBtn.BackgroundColor3 = Color3.fromRGB(0, 180, 100)
        fastAttackStatus.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
        fastAttackIcon.Text = "âœ…"
        fastAttackText.Text = "å¿«é€Ÿæ”»æ“Š [ON]"
        
        print("âš¡ å¿«é€Ÿæ”»æ“Šå·²å•Ÿå‹•")
        
        -- è¨­ç½®å¿«é€Ÿæ”»æ“Šæ¨™èªŒ
        _G.FastAttack = true
        
        -- å•Ÿå‹•å¿«é€Ÿæ”»æ“Š
        fastAttackConnection = task.spawn(function()
            if _G.FastAttack then
                local _ENV = (getgenv or getrenv or getfenv)()

                local function SafeWaitForChild(parent, childName)
                    local success, result = pcall(function()
                        return parent:WaitForChild(childName)
                    end)
                    if not success or not result then
                        warn("noooooo: " .. childName)
                    end
                    return result
                end

                local function WaitChilds(path, ...)
                    local last = path
                    for _, child in {...} do
                        last = last:FindFirstChild(child) or SafeWaitForChild(last, child)
                        if not last then break end
                    end
                    return last
                end

                local VirtualInputManager = game:GetService("VirtualInputManager")
                local CollectionService = game:GetService("CollectionService")
                local ReplicatedStorage = game:GetService("ReplicatedStorage")
                local TeleportService = game:GetService("TeleportService")
                local RunService = game:GetService("RunService")
                local Players = game:GetService("Players")
                local Player = Players.LocalPlayer

                if not Player then
                    warn("æœªæ‰¾åˆ°æœ¬åœ°ç©å®¶.")
                    return
                end

                local Remotes = SafeWaitForChild(ReplicatedStorage, "Remotes")
                if not Remotes then return end

                local Validator = SafeWaitForChild(Remotes, "Validator")
                local CommF = SafeWaitForChild(Remotes, "CommF_")
                local CommE = SafeWaitForChild(Remotes, "CommE")

                local ChestModels = SafeWaitForChild(workspace, "ChestModels")
                local WorldOrigin = SafeWaitForChild(workspace, "_WorldOrigin")
                local Characters = SafeWaitForChild(workspace, "Characters")
                local Enemies = SafeWaitForChild(workspace, "Enemies")
                local Map = SafeWaitForChild(workspace, "Map")

                local EnemySpawns = SafeWaitForChild(WorldOrigin, "EnemySpawns")
                local Locations = SafeWaitForChild(WorldOrigin, "Locations")

                local RenderStepped = RunService.RenderStepped
                local Heartbeat = RunService.Heartbeat
                local Stepped = RunService.Stepped

                local Modules = SafeWaitForChild(ReplicatedStorage, "Modules")
                local Net = SafeWaitForChild(Modules, "Net")

                local sethiddenproperty = sethiddenproperty or function(...) return ... end
                local setupvalue = setupvalue or (debug and debug.setupvalue)
                local getupvalue = getupvalue or (debug and debug.getupvalue)

                local Settings = {
                    AutoClick = true,
                    ClickDelay = 0.3
                }

                local Module = {}

                Module.FastAttack = (function()
                    if _ENV.rz_FastAttack then
                        return _ENV.rz_FastAttack
                    end

                    local FastAttack = {
                        Distance = 10000,
                        attackMobs = true,
                        attackPlayers = true,
                        Equipped = nil
                    }

                    local RegisterAttack = SafeWaitForChild(Net, "RE/RegisterAttack")
                    local RegisterHit = SafeWaitForChild(Net, "RE/RegisterHit")

                    local function IsAlive(character)
                    return character and character:FindFirstChild("Humanoid") and character.Humanoid.Health > 0
                    end

                    local function ProcessEnemies(OthersEnemies, Folder)
                        local BasePart = nil
                        for _, Enemy in Folder:GetChildren() do
                            local Head = Enemy:FindFirstChild("Head")
                            if Head and IsAlive(Enemy) and Player:DistanceFromCharacter(Head.Position) < FastAttack.Distance then
                                if Enemy ~= Player.Character then
                                    table.insert(OthersEnemies, { Enemy, Head })
                                    BasePart = Head
                                end
                            end
                        end
                        return BasePart
                    end

                    function FastAttack:Attack(BasePart, OthersEnemies)
                        if not BasePart or #OthersEnemies == 0 then return end
                        RegisterAttack:FireServer(Settings.ClickDelay or 0)
                        RegisterHit:FireServer(BasePart, OthersEnemies)
                    end

                    function FastAttack:AttackNearest()
                        local OthersEnemies = {}
                        local Part1 = ProcessEnemies(OthersEnemies, Enemies)
                        local Part2 = ProcessEnemies(OthersEnemies, Characters)
                        if #OthersEnemies > 0 then
                            self:Attack(Part1 or Part2, OthersEnemies)
                        else
                            task.wait(0)
                        end
                    end

                    function FastAttack:BladeHits()
                        local Equipped = IsAlive(Player.Character) and Player.Character:FindFirstChildOfClass("Tool")
                        if Equipped and Equipped.ToolTip ~= "Gun" then
                            self:AttackNearest()
                        else
                            task.wait(0)
                        end
                    end

                    task.spawn(function()
                        while task.wait(Settings.ClickDelay) do
                            if not _G.FastAttack then  -- æª¢æŸ¥æ˜¯å¦æ‡‰è©²åœæ­¢
                                break
                            end
                            if Settings.AutoClick then
                                FastAttack:BladeHits()
                            end
                        end
                    end)

                    _ENV.rz_FastAttack = FastAttack
                    return FastAttack
                end)()
            end
        end)
        
    else
        fastAttackBtn.BackgroundColor3 = Color3.fromRGB(30, 40, 55)
        fastAttackStatus.BackgroundColor3 = Color3.fromRGB(80, 80, 100)
        fastAttackIcon.Text = "âš¡"
        fastAttackText.Text = "å¿«é€Ÿæ”»æ“Š"
        
        print("ğŸ›‘ å¿«é€Ÿæ”»æ“Šå·²åœæ­¢")
        
        -- åœæ­¢å¿«é€Ÿæ”»æ“Š
        _G.FastAttack = false
        
        -- å¦‚æœæœ‰é€£æ¥å‰‡åœæ­¢
        if fastAttackConnection then
            pcall(function()
                task.cancel(fastAttackConnection)
                fastAttackConnection = nil
            end)
        end
        
        -- æ¸…ç†ç’°å¢ƒè®Šé‡
        if getgenv then
            getgenv().rz_FastAttack = nil
        end
    end
end

-- ========================
-- è…³æœ¬åŠ è¼‰åŠŸèƒ½
-- ========================
local function loadScript(name, url, button, status, text, icon)
    print("ğŸ“¥ æ­£åœ¨åŠ è¼‰: " .. name)
    
    local success, result = pcall(function()
        return loadstring(game:HttpGet(url))()
    end)
    
    if success then
        print("âœ… " .. name .. " åŠ è¼‰æˆåŠŸ")
        if button and status then
            button.BackgroundColor3 = Color3.fromRGB(0, 180, 100)
            status.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
        end
    else
        print("âŒ " .. name .. " åŠ è¼‰å¤±æ•—")
        if button and status then
            button.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
            status.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        end
    end
end

-- æŒ‰éˆ•äº‹ä»¶
piScriptBtn.MouseButton1Click:Connect(function()
    loadScript("çš®è…³æœ¬", "https://raw.githubusercontent.com/xiaopi77/xiaopi77/main/QQ1002100032-Roblox-Pi-script.lua", 
               piScriptBtn, piStatus, piText, piIcon)
end)

xaBtn.MouseButton1Click:Connect(function()
    loadScript("XAè…³æœ¬", "https://raw.gitcode.com/Xingtaiduan/Scripts/raw/main/Loader.lua", 
               xaBtn, xaStatus, xaText, xaIcon)
end)

flightBtn.MouseButton1Click:Connect(function()
    loadScript("é£›è¡Œè…³æœ¬", "https://raw.githubusercontent.com/kexuan001/rjrym/refs/heads/main/fly.lua", 
               flightBtn, flightStatus, flightText, flightIcon)
end)

fpsBoostBtn.MouseButton1Click:Connect(function()
    loadScript("FPSå„ªåŒ–", "https://raw.githubusercontent.com/kexuan001/rjrym/refs/heads/main/fpsboost", 
               fpsBoostBtn, fpsStatus, fpsText, fpsIcon)
end)

fastAttackBtn.MouseButton1Click:Connect(toggleFastAttack)

-- ========================
-- è‡ªå‹•V4åŠŸèƒ½ï¼ˆæ‚¨æä¾›çš„æ–°ä»£ç¢¼ï¼‰
-- ========================
local autoV4Active = false
local autoV4Connection = nil

local function callAwakeningRemote()
    local Backpack = player:FindFirstChild("Backpack")
    if not Backpack then 
        warn("æ‰¾ä¸åˆ°èƒŒåŒ…")
        return false
    end
    
    local Awakening = Backpack:FindFirstChild("Awakening")
    if not Awakening then 
        warn("æ‰¾ä¸åˆ°Awakening")
        return false
    end
    
    local RemoteFunc = Awakening:FindFirstChild("RemoteFunction")
    if not RemoteFunc or not RemoteFunc:IsA("RemoteFunction") then 
        warn("æ‰¾ä¸åˆ°RemoteFunctionæˆ–é¡å‹éŒ¯èª¤")
        return false
    end
    
    local success, err = pcall(function()
        RemoteFunc:InvokeServer(true)
    end)
    if not success then
        warn("è‡ªåŠ¨v4è°ƒç”¨å¤±è´¥ï¼š", err)
        return false
    end
    
    return true
end

local function toggleAutoV4()
    autoV4Active = not autoV4Active
    
    if autoV4Active then
        autoV4Btn.BackgroundColor3 = Color3.fromRGB(0, 180, 100)
        autoV4Status.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
        autoV4Icon.Text = "âœ…"
        autoV4Text.Text = "è‡ªå‹•V4 [ON]"
        
        print("ğŸŒ€ è‡ªå‹•V4å·²å•Ÿå‹•")
        
        -- å•Ÿå‹•è‡ªå‹•V4å¾ªç’°
        autoV4Connection = task.spawn(function()
            while autoV4Active do
                -- èª¿ç”¨Awakeningé ç¨‹å‡½æ•¸
                local success = callAwakeningRemote()
                if success then
                    print("âœ… æˆåŠŸèª¿ç”¨V4è¦ºé†’")
                end
                
                -- ç­‰å¾…ä¸€æ®µæ™‚é–“å†å˜—è©¦ï¼ˆé¿å…éæ–¼é »ç¹ï¼‰
                task.wait(5) -- æ¯5ç§’å˜—è©¦ä¸€æ¬¡
            end
        end)
        
    else
        autoV4Btn.BackgroundColor3 = Color3.fromRGB(30, 40, 55)
        autoV4Status.BackgroundColor3 = Color3.fromRGB(80, 80, 100)
        autoV4Icon.Text = "ğŸŒ€"
        autoV4Text.Text = "è‡ªå‹•V4"
        
        print("ğŸ›‘ è‡ªå‹•V4å·²åœæ­¢")
        
        -- åœæ­¢è‡ªå‹•V4å¾ªç’°
        if autoV4Connection then
            pcall(function()
                task.cancel(autoV4Connection)
                autoV4Connection = nil
            end)
        end
    end
end

autoV4Btn.MouseButton1Click:Connect(toggleAutoV4)

-- ESCéµé—œé–‰ä¸»UI
if not isMobile then
    inputService.InputBegan:Connect(function(input, gameProcessed)
        if not gameProcessed and input.KeyCode == Enum.KeyCode.Escape then
            if isUIVisible then
                toggleUI()
            end
        end
    end)
end

-- ========================
-- åˆå§‹åŒ–å®Œæˆ
-- ========================
print("ğŸ® =================================")
print("ğŸ® ç„ä¸›è…³æœ¬ v9.8 - åŠ è¼‰å®Œæˆ")
print("ğŸ® è¨­å‚™: " .. deviceType)
print("ğŸ® åŠŸèƒ½ç‰¹è‰²:")
print("ğŸ®   âœ… Luna Interface Suite è¼‰å…¥ç•«é¢ï¼ˆç„¡é»‘è‰²èƒŒæ™¯ï¼‰")
print("ğŸ®   âœ… è…³æœ¬å€/åŠŸèƒ½å€åˆ†é¡é¡¯ç¤ºï¼ˆä¸‹ç§»15pxï¼‰")
print("ğŸ®   âœ… å¿«é€Ÿæ”»æ“ŠåŠŸèƒ½ï¼ˆæ–°ç‰ˆä»£ç¢¼ï¼‰")
print("ğŸ®   âœ… è‡ªå‹•V4åŠŸèƒ½ï¼ˆæœ¬åœ°èª¿ç”¨ï¼Œæ¯5ç§’ä¸€æ¬¡ï¼‰")
print("ğŸ®   âœ… å´é‚ŠæŒ‰éˆ•å¯æ‹–å‹•ç§»å‹•")
print("ğŸ®   âœ… æ©«å‘ç¾ä»£åŒ–UI")
print("ğŸ®   âœ… å¤šè…³æœ¬åŠ è¼‰")
print("ğŸ® =================================")

print("ğŸš€ è…³æœ¬åŠ è¼‰å®Œæˆï¼")
print("ğŸ’¡ å±å¹•å·¦ä¸Šè§’æœ‰è—è‰²âš™ï¸æŒ‰éˆ•")
print("ğŸ’¡ æŒ‰ä½âš™ï¸æŒ‰éˆ•å¯ä»¥æ‹–å‹•åˆ°ä»»æ„ä½ç½®")
print("ğŸ’¡ é»æ“Šâš™ï¸æŒ‰éˆ•æ‰“é–‹ä¸»ç•Œé¢")
